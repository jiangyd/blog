---
title: '/etc/resolv.conf配置自定义DNS,系统重启失效问题'
date: 2018-06-15 12:43:50
tags:
 - dns
---

> 在/etc/resolv.conf设置dns，但是系统重启后会被清空（我的系统ubuntu:14.04）

这个文件的开头也说了，不要编辑这个文件，更改会被覆盖的
其中 192.168.0.244 是我搭建的dns,必须放在第一行
202.96.209.133  202.96.209.5  是自动获取的dns

```
# cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 192.168.0.244
nameserver 202.96.209.133
nameserver 202.96.209.5
```

> 修改/etc/resolvconf/resolv.conf.d/head文件，可以保留设置
> 修改/etc/resolvconf/resolv.conf.d/base文件，可以保留设置
> 修改/etc/resolvconf/resolv.conf.d/tail文件，可以保留设置

这3个文件有什么区别
head文件设置的dns放在/etc/resolv.conf最前面
base文件设置的dns放在head与tail中间,但是该文件只能设置一个dns
tail文件设置的dns放在/etc/resolv.conf最后面

> 基于我的需要，dns必须设置为第一个,那么我们需要修改的文件如下

```
# cat /etc/resolvconf/resolv.conf.d/head
nameserver 192.168.0.244
```
>最后重启

```
service resolvconf restart
```

> 如果想去掉动态的DNS，只保留自己定义的DNS,那么就要设置静态的DNS了

方法1:

```
# vim /etc/dhcp/dhclient.conf
supersede domain-name-servers 192.168.0.244;
```

方法2:

```
# vim /etc/network/interfaces
auto eth0
iface eth0 inet dhcp
dns-nameservers 192.168.0.244
```

> 其它系统配置文件及路径可能不同，配置如果没有生效，建议重启系统

